/**
 * Titanium SDK Library for Node.js
 * Copyright (c) 2012 by Appcelerator, Inc. All Rights Reserved.
 * Please see the LICENSE file for information about licensing.
 */
var appc = require('node-appc'),
	path = require('path');
	
exports.constructLegacyCommand = function(cli, tiapp, platform, cmd, emulatorCmd) {

	cmd.push(path.join(path.resolve(cli.env.sdks[tiapp['sdk-version']].path), platform, 'builder.py'));

	if (platform == 'iphone') {
		cmd.push('run', cli.argv['project-dir']);
	} else if (platform == 'mobileweb') {
		cmd.push(cli.argv['project-dir'], cli.argv['deploy-type']);
	} else if (platform == 'android') {
		if (cli.argv['build-only']) {
			cmd.push('build', tiapp.name, cli.argv['android-sdk'], cli.argv['project-dir'] , tiapp.id);
		} else if (cli.argv.target == 'emulator') {
			emulatorCmd.push(cmd[0], 'emulator', tiapp.name, cli.argv['android-sdk'], cli.argv['project-dir'] , tiapp.id, cli.argv['avd-id'], cli.argv['avd-skin']);
			cmd.push('simulator', tiapp.name, cli.argv['android-sdk'], cli.argv['project-dir'] , tiapp.id, cli.argv['avd-id'], cli.argv['avd-skin']);
		} else if (cli.argv.target == 'device') {
			cmd.push('install', tiapp.name, cli.argv['android-sdk'], cli.argv['project-dir'] , tiapp.id, cli.argv['avd-id']);
		} else if (cli.argv.target == 'dist-playstore') {
			cmd.push('distribute', tiapp.name, cli.argv['android-sdk'], cli.argv['project-dir'] , tiapp.id, cli.argv['keystore'], cli.argv['password'], cli.argv['alias'], cli.argv['output-dir']);
		}

		// Add debug host if it's defined
		if (cli.argv['debug-host']) {
			if (cli.argv.target == 'device') {
				cmd.push('');
			}
			cmd.push(cli.argv['debug-host']);
		}
	}
}
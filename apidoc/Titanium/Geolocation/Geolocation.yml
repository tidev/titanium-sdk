---
name: Titanium.Geolocation
summary: The top level Geolocation module. The Geolocation module is used for accessing device location based information.
description: |
    This module combines two sets of features:

    *   Location services. Determining the location of the device.

    *   Geocoding and reverse geocoding. Converting geographic  coordinates into
        addresses, and converting addresses into geographic  coordinates.

    Using location services can have a significant impact on a device's battery life,
    so it's important to use them in the most efficient manner possible. Power consumption
    is strongly influenced by the accuracy and frequency of location updates required by
    your application.

    The location services systems of the underlying platforms are very different, so there
    are significant implementation differences between the platforms.

    The basic methods of requesting location information and receiving location updates
    are essentially the same on all platforms. However, the method of configuring the
    accuracy and frequency of location updates is different for each platform.

    #### Getting Location Information

    There are two ways to get location information:

    *   Make a one-time request with [getCurrentPosition](Titanium.Geolocation.getCurrentPosition).

    *   Register to receive location updates by adding an event listener for the
        [location](Titanium.Geolocation.location) event.

    **NOTE:** Location services stay enabled for as long as a listener is registered for the
    `location` event, so be sure to remove the event listener when you do not require
    location updates.

    #### Configurating Location Updates on iOS

    In iOS, the accuracy (and power consumption) of location services is primarily
    determined by the [accuracy](Titanium.Geolocation.accuracy) setting. This can be set
    to one of the following values:

    *   [ACCURACY_BEST](Titanium.Geolocation.ACCURACY_BEST) (highest accuracy and power consumption)
    *   [ACCURACY_BEST_FOR_NAVIGATION](Titanium.Geolocation.ACCURACY_BEST_FOR_NAVIGATION)
    *   [ACCURACY_HIGH](Titanium.Geolocation.ACCURACY_HIGH)
    *   [ACCURACY_NEAREST_TEN_METERS](Titanium.Geolocation.ACCURACY_NEAREST_TEN_METERS)
    *   [ACCURACY_HUNDRED_METERS](Titanium.Geolocation.ACCURACY_HUNDRED_METERS)
    *   [ACCURACY_KILOMETER](Titanium.Geolocation.ACCURACY_KILOMETER)
    *   [ACCURACY_LOW](Titanium.Geolocation.ACCURACY_LOW)
    *   [ACCURACY_THREE_KILOMETERS](Titanium.Geolocation.ACCURACY_THREE_KILOMETERS) (lowest
        accuracy and power consumption).

    Based on the accuracy you choose, iOS uses its own logic to select location providers
    and filter location updates to provide location updates that meet your accuracy
    requirements.

    You can further limit power consumption on iOS by setting the
    [distanceFilter](Titanium.Geolocation.distanceFilter) property to eliminate position
    updates when the user is not moving.

    In order to receive the user's location, add either the
    [`NSLocationWhenInUseUsageDescription`](https://developer.apple.com/library/content/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html#//apple_ref/doc/uid/TP40009251-SW26)
    or
    [`NSLocationAlwaysUsageDescription`](https://developer.apple.com/library/content/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html#//apple_ref/doc/uid/TP40009251-SW26)
    key to the iOS plist section of the project's `tiapp.xml` file.

    ``` xml
    <ti:app>
        <ios>
            <plist>
                <dict>
                    <key>NSLocationAlwaysUsageDescription</key>
                    <string>
                        Specify the reason for accessing the user's location information.
                        This appears in the alert dialog when asking the user for permission to
                        access their location.
                    </string>
                </dict>
            </plist>
        </ios>
    </ti:app>
    ```

    For iOS 11 and later, also add the [`NSLocationAlwaysAndWhenInUseUsageDescription`](https://developer.apple.com/documentation/corelocation/choosing_the_authorization_level_for_location_services/request_always_authorization)
    when planning to request the "Always" permission. Using the above key, you are also able to upgrade your permissions from
    "When in Use" to "Always", which is the recommended way for managing location permissions in iOS 11 and later.
    Please also remember to request your desired location-permissions before using any geolocation-related API in
    order to receive the best usability and permission-control during the app-lifecycle using <Titanium.Geolocation.hasLocationPermissions>
    and <Titanium.Geolocation.requestLocationPermissions>. Also note that you also need to include the `NSLocationWhenInUseUsageDescription` key
    in *any* case when targeting iOS 11 and later. Descriptive error-logs will be thrown if required permissions are missing.

    #### Configurating Location Updates on Android

    On Android, two different location service modes are supported: *simple*, and *manual*.

    *   *Simple mode* provides a compromise mode that provides adaquate support for
        undemanding location applications without requiring developers to
        write a lot of Android-specific code. To use simple mode:

        1.   Leave the <Titanium.Geolocation.Android.manualMode> flag set to `false` (the
             default value).

        2.   Set the [accuracy](Titanium.Geolocation.accuracy) property to
             either [ACCURACY_HIGH](Titanium.Geolocation.ACCURACY_HIGH) or
             [ACCURACY_LOW](Titanium.Geolocation.ACCURACY_LOW).

    *   *Manual mode* gives developers low-level control of location updates, including
        enabling individual location providers and filtering updates, for the best
        combination of accuracy and battery life.

        Manual mode is used when the <Titanium.Geolocation.Android.manualMode> flag is set
        to `true`. In manual mode, the `accuracy` property is not used, and all
        configuration is done through the <Titanium.Geolocation.Android> module.

    As of Titanium SDK 7.1.0 and later, including the [`ti.playservices`](https://github.com/appcelerator-modules/ti.playservices) module will allow Google Play Services 
    to be used by default to obtain location information. This means the provider passed into [createLocationProvider](Titanium.Geolocation.Android.createLocationProvider)
    will be ignored, as Google Play Services will select the best provider based on current device conditions.
    If Google Play Services is not available it will fallback to previous behaviour of using Android location APIs.

    To retrieve location events:

    ``` js
    var win = Ti.UI.createWindow({ backgroundColor: 'white' });

    Ti.Geolocation.accuracy = Ti.Geolocation.ACCURACY_HIGH;

    function getLocation() {
        Ti.Geolocation.addEventListener('location', function(e) {
            alert(JSON.stringify(e, null, 2));
        });
    }

    win.addEventListener('open', function() {
        if (Ti.Geolocation.hasLocationPermissions()) {
            getLocation();
          } else {
            Ti.Geolocation.requestLocationPermissions(Ti.Geolocation.AUTHORIZATION_ALWAYS, function(e) {
                if (e.success) {
                    getLocation();
                } else {
                    alert('could not obtain location permissions');
                }
            });
        }
    });

    win.open();
    ```

    #### Using the Compass

    Both iOS and Android support a receiving heading updates from a hardware compass, if available.

    Check the [hasCompass](Titanium.Geolocation.hasCompass) property to see if the current
    device supports a compass.

    To retrieve compass readings, you can either use
    [getCurrentHeading](Titanium.Geolocation.getCurrentHeading) as shown in the
    previous example, or add a listener for the
    [heading](Titanium.Geolocation.heading) event, as shown below:

    ``` js
    function compassHandler (e) {
      if (e.success) {
        Ti.API.info('Heading: ' + e.heading.magneticHeading);
      }
    }
    Ti.Geolocation.addEventListener('heading', compassHandler);
    ```

    Note that Android did not include a `success` property in the `heading` event prior to SDK 7.5.0.
    Heading events are only generated on Android when heading data is available. So if
    `success` is undefined on prior SDK versions, we assume that the event contains valid compass data.

    To obtain true heading data for the compass (as opposed to magnetic heading data),
    a current location fix is required. See the notes on
    [trueHeading](HeadingData.trueHeading) for more information.

    As with location updates, the application should unregister for heading updates
    when it is no longer being used, or when it goes into the background. Use
    `removeEventListener` to stop heading updates:

    ``` js
    Ti.Geolocation.removeEventListener('heading', compassHandler);
    ```

    Finally, note that neither the Android emulator nor the iOS simulator provide
    compass support. Compass code must be tested on physical devices.

    #### Geocoding Services

    The module provides two methods, [forwardGeocoder](Titanium.Geolocation.forwardGeocoder) and [reverseGeocoder](Titanium.Geolocation.reverseGeocoder)
    to convert between geographic coordinates and addresses. These methods map to MapQuest Open Nominatim Search Service.

    While this API has the advantage that it has no daily usage limits, please note that the data backing this API is crowd sourced and might not return
    proper values for valid addresses and geographic coordinates.

    If geocoding services are essential component of the application, developers are encouraged to use commercial geocoding providers.

extends: Titanium.Module
since: "0.1"
platforms: [android, iphone, ipad, macos]
methods:
  - name: forwardGeocoder
    summary: Resolves an address to a location.
    parameters:
      - name: address
        summary: address to resolve.
        type: String
      - name: callback
        summary: |
            Function to invoke on success or failure.
            Optional on SDK 10, as this method will return a `Promise`, which may be used to handle the result.
        type: Callback<ForwardGeocodeResponse>
        optional: true
    returns:
      summary: On SDK 10+, this method will return a `Promise` whose resolved value is equivalent to that passed to the optional callback argument.
      type: Promise<ForwardGeocodeResponse>

  - name: getCurrentHeading
    summary: Retrieves the current compass heading.
    parameters:
      - name: callback
        summary: |
            Function to invoke on success or failure of obtaining the current heading.
            Optional on SDK 10, as this method will return a `Promise`, which may be used to handle the result.
        type: Callback<HeadingResponse>
        optional: true
    returns:
      summary: On SDK 10+, this method will return a `Promise` whose resolved value is equivalent to that passed to the optional callback argument.
      type: Promise<HeadingResponse>

  - name: getCurrentPosition
    summary: Retrieves the last known location from the device.
    description: |
        On Android, the radios are not turned on to update the location, and a cached
        location is used.

        On iOS the radios **may** be used if the location is too "old".
    parameters:
      - name: callback
        summary: |
            Function to invoke on success or failure of obtaining the current location.
            Optional on SDK 10, as this method will return a `Promise`, which may be used to handle the result.
        type: Callback<LocationResults>
        optional: true
    returns:
      summary: On SDK 10+, this method will return a `Promise` whose resolved value is equivalent to that passed to the optional callback argument.
      type: Promise<LocationResults>

  - name: hasLocationPermissions
    summary: Returns `true` if the app has location access.
    parameters:
      - name: authorizationType
        summary: Types of geolocation's authorizations. This is an iOS only parameter and is ignored on Android.
        constants: [Titanium.Geolocation.AUTHORIZATION_ALWAYS, Titanium.Geolocation.AUTHORIZATION_WHEN_IN_USE]
        type: Number
    returns:
        type: Boolean
    since: "5.1.0"

  - name: requestLocationPermissions
    summary: Requests for location access.
    description: |
        On Android, the request view will show if the permission is not accepted by the user, and the user did
        not check the box "Never ask again" when denying the request. If the user checks the box "Never ask again,"
        the user has to manually enable the permission in device settings. If the user asks for permissions or
        tries to get unauthorized location information, then the app should call the request method to show
        the permission settings. This method requests `Manifest.permission.ACCESS_FINE_LOCATION` on Android.
        If you require other permissions, you can also use <Titanium.Android.requestPermissions>.

        In iOS 8, Apple introduced the Info.plist keys `NSLocationWhenInUseUsageDescription` and `NSLocationAlwaysUsageDescription`
        that are used to display an own description while requesting location permissions. In addition to this method, you need to
        include one of these keys (based on how your location updates should behave) or the application will crash if your app does not.

        In iOS 11, Apple introduced another Info.plist key `NSLocationAlwaysAndWhenInUseUsageDescription` that allows developers to upgrade
        their permissions from "When in Use" to "Always". In order to get the best usability for iOS 11 and later, request "When in Use" first
        and upgrade your location-permissions by requesting "Always" permissions later if required. If this permission-flow is not used, iOS
        will still ask the user to select between "When in Use", "Always", and "Don't Allow" (primary action) on iOS 11 when asking for "Always"
        permissions, which can lead to a higher frequence of denied permissions, so be careful requesting location permissions.
        The iOS 11 related upgrade-flow is available in Titanium SDK 6.3.0 and later.

        Finally, iOS 11 and later will require you to *always* include the `NSLocationWhenInUseUsageDescription` permission and Titanium will throw a
        descriptive error-log if any required keys are missing.

        More infos:
          * [Available Info.plist keys](https://developer.apple.com/library/content/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html)
          * [Request Always Authorization](https://developer.apple.com/documentation/corelocation/choosing_the_authorization_level_for_location_services/request_always_authorization)
    parameters:
      - name: authorizationType
        summary: Types of geolocation's authorizations. This is an iOS only parameter and is ignored on Android.
        constants: [Titanium.Geolocation.AUTHORIZATION_ALWAYS,Titanium.Geolocation.AUTHORIZATION_WHEN_IN_USE]
        type: Number
      - name: callback
        summary: |
            Function to call upon user decision to grant location access.
            Optional on SDK 10, as this method will return a `Promise`, which may be used to handle the result.
        type: Callback<LocationAuthorizationResponse>
        optional: true
    returns:
      summary: On SDK 10+, this method will return a `Promise` whose resolved value is equivalent to that passed to the optional callback argument.
      type: Promise<LocationAuthorizationResponse>
    since: "5.1.0"

  - name: requestTemporaryFullAccuracyAuthorization
    summary: Requests the user's permission to temporarily use location services with full accuracy.
    description: |
        If your app doesn't have permission to access accurate location (see [locationAccuracyAuthorization](Titanium.Geolocation.locationAccuracyAuthorization), 
        you can use this method to request temporary access to accurate location.  This access will expire automatically, 
        but it won't expire while the user is still engaged with your app.  So, for example, while your app is in 
        the foreground your app will retain the temporary access it was granted. Similarly, if your app starts a 
        Continuous Background Location session with the background location indicator enabled (see [showBackgroundLocationIndicator](Titanium.Geolocation.showBackgroundLocationIndicator), 
        your access to accurate location will remain as long as the background location indicator remains enabled.  
        This allows your app to provide session-oriented experiences which require accurate location (e.g. fitness or navigation), 
        even if the user has decided not to grant your app persistent access to accurate location. 

        You need to add key `NSLocationTemporaryUsageDescriptionDictionary` in `tiapp.xml`. See following example -

        ``` xml
        <ti:app>
            <ios>
                <plist>
                    <dict>
                        <key>NSLocationTemporaryUsageDescriptionDictionary</key>
                        <dict>
                            <key>PurposeKey1</key>
                            <string>
                                Specify the reason for accessing the user's location data with full accuracy.
                                This appears in the alert dialog when asking the user for permission to
                                access their location.
                            </string>
                            <key>PurposeKey2</key>
                            <string>
                                Specify the reason for accessing the user's location data with full accuracy.
                                This appears in the alert dialog when asking the user for permission to
                                access their location.
                            </string>
                        </dict>
                    </dict>
                </plist>
            </ios>
        </ti:app>
        ```

        When CoreLocation prepares the prompt for display, it will look at the NSLocationTemporaryUsageDescriptionDictionary key 
        in your tiapp.xml.  The value should be a dictionary containing usage descriptions.  The purposeKey you provide to 
        this method must correspond to an entry in that dictionary.
    parameters:
      - name: purposeKey
        summary: |
            A key in the NSLocationTemporaryUsageDescriptionDictionary dictionary of the app's tiapp.xml file. 
            The value for this key is an app-provided string that describes the reason for accessing 
            location data with full accuracy.
        type: String
      - name: callback
        summary: Function to call upon user decision to grant authorization.
        type: Callback<LocationAccuracyAuthorizationResponse>
    platforms: [iphone, ipad]
    osver: {ios: {min: "14.0"}}
    since: "9.2.0"

  - name: reverseGeocoder
    summary: Tries to resolve a location to an address.
    description: |
        The callback receives a <ReverseGeocodeResponse> object. If the request
        is successful, the object includes one or more addresses that are possible matches
        for the requested coordinates.
    parameters:
      - name: latitude
        summary: Latitude to search, specified in decimal degrees.
        type: Number

      - name: longitude
        summary: Longitude to search, specified in decimal degrees.
        type: Number

      - name: callback
        summary: |
            Function to invoke on success or failure.
            Optional on SDK 10, as this method will return a `Promise`, which may be used to handle the result.
        type: Callback<ReverseGeocodeResponse>
        optional: true
    returns:
      summary: On SDK 10+, this method will return a `Promise` whose resolved value is equivalent to that passed to the optional callback argument.
      type: Promise<ReverseGeocodeResponse>

events:
  - name: calibration
    summary: Fired when the device detects interface and requires calibration.
    description: |
        When this event is fired, the iOS calibration UI is being displayed to the end user.
    platforms: [iphone, ipad, macos]

  - name: heading
    summary: Fired when an heading update is received.
    properties:
      - name: code
        summary: If `success` is `false`, the error code is available.
        type: Number

      - name: success
        summary: Indicate if the heading event was successfully received. Android returns this since SDK 7.5.0.
        type: Boolean

      - name: error
        summary: If `success` is false, a string describing the error.
        type: String

      - name: heading
        summary: Dictionary object containing the heading data.
        type: HeadingData

  - name: location
    summary: Fired when a location update is received.
    properties:
      - name: code
        summary: if `success` is false, the error code if available.
        type: Number

      - name: success
        summary: Indicates if location data was successfully retrieved.
        type: Boolean

      - name: provider
        platforms: [android]
        summary: If `success` is true, object describing the location provider generating this update.
        type: LocationProviderDict

      - name: coords
        summary: If `success` is true, actual location data for this update.
        type: LocationCoordinates

      - name: error
        summary: If `success` is false, a string describing the error.
        type: String

  - name: locationupdatepaused
    summary: Fired when location updates are paused by the OS.
    description: |
        This event is fired when [pauseLocationUpdateAutomatically](Titanium.Geolocation.pauseLocationUpdateAutomatically)
        is set to `true` and if the OS detects that the device's location is not changing,
        causing it to pause the delivery of updates in order to shut down the appropriate
        hardware and save power.
    platforms: [iphone, ipad, macos]
    since: "3.1.0"

  - name: locationupdateresumed
    summary: Fired when location manager is resumed by the OS.
    description: |
        When location updates are paused and need to be resumed (perhaps because the user
        is moving again), this event is fired to let the app know that it is about to
        begin the delivery of those updates again.
    platforms: [iphone, ipad, macos]
    since: "3.1.0"

  - name: authorization
    summary: Fired when changes are made to the authorization status for location services.
    description: |
        This event is fired whenever the application's ability to use location services changes.
        Changes can occur because the user allowed or denied the use of location services for the app or the system as a whole.
    properties:
      - name: authorizationStatus
        summary: New authorization status for the application.
        type: Number
        constants: Titanium.Geolocation.AUTHORIZATION_*
    platforms: [iphone, ipad, macos]
    osver: {ios: {min: "8.0"}}
    since: "3.4.0"

properties:
  - name: ACCURACY_BEST
    summary: |
        Use with [accuracy](Titanium.Geolocation.accuracy) to request the best
        accuracy available.
    description: |
        Using this value results in the most accurate location updates, and the highest
        battery usage.

        Using this value on Android enables *legacy mode* operation, which is not
        recommended.
    type: Number
    permission: read-only
    platforms: [iphone, ipad, macos]

  - name: ACCURACY_HUNDRED_METERS
    summary: |
        Use with [accuracy](Titanium.Geolocation.accuracy) to request location
        updates accurate to the nearest 100 meters.
    description: |
        Using this value on Android enables *legacy mode* operation, which is not
        recommended.
    type: Number
    permission: read-only
    platforms: [iphone, ipad, macos]

  - name: ACCURACY_KILOMETER
    summary: |
        Use with [accuracy](Titanium.Geolocation.accuracy) to request location
        updates accurate to the nearest kilometer.
    description: |
        Using this value on Android enables *legacy mode* operation, which is not
        recommended.
    type: Number
    permission: read-only
    platforms: [iphone, ipad, macos]

  - name: ACCURACY_NEAREST_TEN_METERS
    summary: |
        Use with [accuracy](Titanium.Geolocation.accuracy) to request location
        updates accurate to the nearest 10 meters.
    description: |
        Using this value on Android enables *legacy mode* operation, which is not
        recommended.
    type: Number
    permission: read-only
    platforms: [iphone, ipad, macos]

  - name: ACCURACY_THREE_KILOMETERS
    summary: |
        Use with [accuracy](Titanium.Geolocation.accuracy) to request location
        updates accurate to the nearest three kilometers.
    description: |
        Using this value on Android enables *legacy mode* operation, which is not
        recommended.
    type: Number
    permission: read-only
    platforms: [iphone, ipad, macos]

  - name: ACCURACY_HIGH
    summary: |
        Use with [accuracy](Titanium.Geolocation.accuracy) to request more
        accurate location updates with higher battery usage.
    description: |
        Using this value on Android enables *simple mode* operation.
    type: Number
    permission: read-only
    since: "2.0.0"

  - name: ACCURACY_BEST_FOR_NAVIGATION
    summary: |
        Use with [accuracy](Titanium.Geolocation.accuracy) to request highest possible
        accuracy and combine it with additional sensor data.
    description: |
        Using this value is intended for use in navigation applications that require
        precise position information at all times and are intended to be used only while
        the device is plugged in.
    type: Number
    permission: read-only
    platforms: [iphone, ipad, macos]
    since: "3.1.0"

  - name: ACCURACY_LOW
    summary: |
        Use with [accuracy](Titanium.Geolocation.accuracy) to request less
        accurate location updates with lower battery usage.
    description: |
        Using this value on Android enables *simple mode* operation.
    type: Number
    permission: read-only
    since: "2.0.0"

  - name: ACCURACY_REDUCED
    summary: |
        The level of accuracy used when an app isn’t authorized for full accuracy location data.
    description: |
        Use with [accuracy](Titanium.Geolocation.accuracy).
        The accuracy of location data is reduced in both space and time using approaches like 
        selecting a nearby point of interest and updating the location at most a few times per hour. 
        The approximate location preserves the user’s country, typically preserves the city, 
        and is usually within 1–20 kilometers of the actual location.
        If your app is authorized to access location information with full accuracy, you can use 
        this constant to access location data as if the app didn’t have that authorization.
    type: Number
    permission: read-only
    platforms: [iphone, ipad]
    osver: {ios: {min: "14.0"}}
    since: "9.2.0"

  - name: AUTHORIZATION_AUTHORIZED
    summary: |
        A [locationServicesAuthorization](Titanium.Geolocation.locationServicesAuthorization) value
        indicating that the application is authorized to use location services.
    type: Number
    permission: read-only
    platforms: [iphone, ipad, macos]
    deprecated:
        since: "7.0.0"
        notes: Use [Titanium.Geolocation.AUTHORIZATION_ALWAYS](Titanium.Geolocation.AUTHORIZATION_ALWAYS) as advised by Apple.

  - name: AUTHORIZATION_DENIED
    summary: |
        A [locationServicesAuthorization](Titanium.Geolocation.locationServicesAuthorization) value
        indicating that the application is not authorized to use location services, *or*
        location services are disabled.
    type: Number
    permission: read-only
    platforms: [iphone, ipad, macos]

  - name: AUTHORIZATION_RESTRICTED
    summary: |
        A [locationServicesAuthorization](Titanium.Geolocation.locationServicesAuthorization) value
        indicating that the application is not authorized to use location servies *and*
        the user cannot change this application's status.
    type: Number
    permission: read-only
    platforms: [iphone, ipad, macos]

  - name: AUTHORIZATION_UNKNOWN
    summary: |
        A [locationServicesAuthorization](Titanium.Geolocation.locationServicesAuthorization) value
        indicating that the authorization state is unknown.
    type: Number
    permission: read-only
    platforms: [iphone, ipad, macos]

  - name: AUTHORIZATION_ALWAYS
    summary: |
        A [locationServicesAuthorization](Titanium.Geolocation.locationServicesAuthorization) value
        indicating that the application is authorized to start location services at any time. This authorization
        includes the use of all location services, including monitoring regions and significant location changes.
    type: Number
    permission: read-only
    platforms: [iphone, ipad, macos]
    osver: {ios: {min: "8.0"}}
    since: "3.4.0"

  - name: AUTHORIZATION_WHEN_IN_USE
    summary: |
        A [locationServicesAuthorization](Titanium.Geolocation.locationServicesAuthorization) value
        indicating that the application is authorized to start most location services only while running in the foreground.
    type: Number
    permission: read-only
    platforms: [iphone, ipad, macos]
    osver: {ios: {min: "8.0"}}
    since: "3.4.0"

  - name: ERROR_DENIED
    summary: Error code indicating that the user denied access to the location service.
    platforms: [iphone, ipad, macos]
    type: Number
    permission: read-only

  - name: ERROR_HEADING_FAILURE
    summary: Error code indicating that the heading could not be determined.
    platforms: [iphone, ipad, macos]
    type: Number
    permission: read-only

  - name: ERROR_LOCATION_UNKNOWN
    summary: Error code indicating that the user's location could not be determined.
    platforms: [iphone, ipad, macos]
    type: Number
    permission: read-only

  - name: ERROR_NETWORK
    summary: Error code indicating that the network was unavailable.
    platforms: [iphone, ipad, macos]
    type: Number
    permission: read-only

  - name: ERROR_REGION_MONITORING_DELAYED
    summary: Error code indicating that region monitoring is delayed.
    platforms: [iphone, ipad, macos]
    permission: read-only
    type: Number

  - name: ERROR_REGION_MONITORING_DENIED
    summary: Error code indicating that region monitoring is denied.
    type: Number
    permission: read-only
    platforms: [iphone, ipad, macos]

  - name: ERROR_REGION_MONITORING_FAILURE
    summary: Error code indicating a region monitoring failure.
    type: Number
    permission: read-only
    platforms: [iphone, ipad, macos]

  - name: ACTIVITYTYPE_OTHER
    summary: The location data is being used for an unknown activity.
    description: |
        Used with [activityType](Titanium.Geolocation.activityType).
    type: String
    permission: read-only
    platforms: [iphone,ipad, macos]
    since: "3.1.0"

  - name: ACTIVITYTYPE_AUTOMOTIVE_NAVIGATION
    summary: The location data is used for tracking location changes to the automobile specifically during vehicular navigation.
    description: |
        Used with [activityType](Titanium.Geolocation.activityType). This activity might
        cause location updates to be paused only when the vehicle does not move for an
        extended period of time.
    type: String
    permission: read-only
    platforms: [iphone,ipad, macos]
    since: "3.1.0"

  - name: ACTIVITYTYPE_FITNESS
    summary: The location data is used for tracking any pedestrian-related activity.
    description: |
        Used with [activityType](Titanium.Geolocation.activityType). This activity might
        cause location updates to be paused only when the user does not move a significant
        distance over a period of time.
    type: String
    permission: read-only
    platforms: [iphone,ipad, macos]
    since: "3.1.0"

  - name: ACTIVITYTYPE_OTHER_NAVIGATION
    summary: |
        The location data is used for tracking movements of other types of vehicular
        navigation that are not automobile related.
    description: |
        Used with [activityType](Titanium.Geolocation.activityType). You would use this
        to track navigation by boat, train, or plane. Do not use this type for pedestrian
        navigation tracking. This activity might cause location updates to be paused only
        when the vehicle does not move a significant distance over a period of time.
    type: String
    permission: read-only
    platforms: [iphone,ipad, macos]
    since: "3.1.0"

  - name: ACCURACY_AUTHORIZATION_FULL
    summary: The user authorized the app to access location data with full accuracy.
    type: Number
    permission: read-only
    osver: {ios: {min: "14.0"}}
    platforms: [iphone,ipad]
    since: "9.2.0"

  - name: ACCURACY_AUTHORIZATION_REDUCED
    summary: The user authorized the app to access location data with reduced accuracy.
    type: Number
    permission: read-only
    osver: {ios: {min: "14.0"}}
    platforms: [iphone,ipad]
    since: "9.2.0"

  - name: accuracy
    summary: Specifies the requested accuracy for location updates.
    description: |
        For basic location updates on all platforms, set `accuracy` to either:

        *   [ACCURACY_HIGH](Titanium.Geolocation.ACCURACY_HIGH) for higher-quality location
            updates, with the higher power consumption.
        *   [ACCURACY_LOW](Titanium.Geolocation.ACCURACY_LOW) for lower-quality location
            updates with lower power consumption.

        For finer-grained control on iOS, specify one of `ACCURACY_BEST`,
        `ACCURACY_NEAREST_TEN_METERS`, `ACCURACY_HUNDRED_METERS`, `ACCURACY_KILOMETER`, or
        `ACCURACY_THREE_KILOMETERS`.

        For finer-grained control on Android, use *manual mode*, instead of specifing an accuracy.
        This mode requires more active management on the part of the application, but it
        is recommended to maximize accuracy and battery life.
        See <Titanium.Geolocation.Android> for details on using manual mode.
    type: Number
    constants: [Titanium.Geolocation.ACCURACY_HIGH, Titanium.Geolocation.ACCURACY_BEST_FOR_NAVIGATION, Titanium.Geolocation.ACCURACY_LOW, Titanium.Geolocation.ACCURACY_BEST, Titanium.Geolocation.ACCURACY_NEAREST_TEN_METERS,
    Titanium.Geolocation.ACCURACY_HUNDRED_METERS, Titanium.Geolocation.ACCURACY_KILOMETER, Titanium.Geolocation.ACCURACY_THREE_KILOMETERS, Titanium.Geolocation.ACCURACY_REDUCED]

  - name: distanceFilter
    summary: The minimum change of position (in meters) before a 'location' event is fired.
    description: |
        If set to 0, distance filtering is disabled, meaning that location events are
        generated continuously.
    type: Number
    default: 0
    platforms: [iphone, ipad, macos]

  - name: frequency
    deprecated:
        since: "2.0.0"
        removed: "8.0.0"
        notes: |
            Android legacy mode operation is deprecated. For new development, use
            either simple mode or manual mode. See "Configurating Location Updates on Android"
            in the main description of this class for more information.
    summary: Requested frequency for location updates, in milliseconds.
    description: |
        Setting a frequency value enables legacy location mode on Android.
        Note that only a single provider can be active at one time in legacy mode.
         Note that the frequency value is used as a guideline: there are no guarantees
        that the device will provide updates at the specified frequency.
         A lower frequency value generally increases power consumption.
        A value of 0 means that updates should be generated as quickly as possible.
    type: Number
    platforms: [android]

  - name: hasCompass
    summary: Indicates whether the current device supports a compass.
    type: Boolean
    permission: read-only

  - name: headingFilter
    summary: Minimum heading change (in degrees) before a `heading` event is fired.
    description: |
        Set to a value greater than zero to reduce the number of heading events generated.
    type: Number
    default: 0 (No limit on heading updates)
    platforms: [iphone, ipad, macos]

  - name: locationServicesAuthorization
    summary: Returns an authorization constant indicating if the application has access to location services.
    description: |
        If `locationServicesAuthorization` is `AUTHORIZATION_RESTRICTED`, you should not
        attempt to re-authorize: this will lead to issues.
    type: Number
    constants: Titanium.Geolocation.AUTHORIZATION_*
    platforms: [iphone, ipad, macos]
    permission: read-only

  - name: locationServicesEnabled
    summary: Indicates if the user has enabled or disabled location services for the device (not the application).
    description: |
        This method returns `true` if *any* location provider is enabled.

        On Android, there is a "passive" location provider that is enabled
        at all times, even when the user disables both the GPS and Network location providers.
        Therefore, this method returns `true` on these devices if only there is GPS or network provider available.
    type: Boolean
    permission: read-only

  - name: preferredProvider
    deprecated:
        since: "2.0.0"
        removed: "8.0.0"
        notes: |
            Android legacy mode operation is deprecated. For new development, use
            either simple mode or manual mode. See "Configurating Location Updates on Android"
            in the main description of this class for more information.
    summary: |
        Determines the preferred location provider.
    description: |
        Setting a preferred provider enables legacy location mode on Android.
        Note that only a single provider can be active at one time in legacy mode.
         The preferred provider affects power consumption. In general, `PROVIDER_GPS`
        requires the most power, and `PROVIDER_PASSIVE` requires the least.
         If `undefined`, the preferred provider is auto-detected.
    type: String
    constants: Titanium.Geolocation.Android.PROVIDER_*
    platforms: [android]
    default: <Titanium.Geolocation.Android.PROVIDER_NETWORK>

  - name: showCalibration
    summary: Determines whether the compass calibration UI is shown if needed.
    description: |
        Set to `false` to disable display of the compass calibration UI. This may result
        in invalid heading data.
    type: Boolean
    default: true
    platforms: [iphone, ipad, macos]

  - name: showBackgroundLocationIndicator
    summary: |
        Specifies that an indicator be shown when the app makes use of continuous
        background location updates.
    description: |
        Starting continuous background location updates requires the app to
        set `UIBackgroundModes` to include "location" and to set this property
        to `true` before calling `getCurrentPosition` with the intent to continue
        in the background.

        Note that this property only applies to apps with Always authorization.
        For apps with WhenInUse authorization, the indicator is always shown when
        using continuous background location updates in order to maintain user
        visibility and that the app is still in use.
    type: Boolean
    default: false
    since: "7.3.0"
    osver: { ios: { min: "11.0" } }
    platforms: [iphone, ipad, macos]

  - name: trackSignificantLocationChange
    summary: |
        Indicates if the location changes should be updated only when a significant change
        in location occurs.
    description: |
        The trackSignificantLocationChange service offers a low-power location service for
        devices with cellular radios.

        This service offers a significant power savings and provides accuracy that is good
        enough for most applications. It uses the device's cellular radio to determine the
        user's location  and report changes in that location, allowing the system to manage
        power usage much more aggressively than it could otherwise. This service is also
        capable of waking up an application that is currently suspended or not running in
        order to deliver new location data.
    type: Boolean
    default: false
    platforms: [iphone, ipad, macos]
    since: "2.1.2"

  - name: allowsBackgroundLocationUpdates
    summary: |
        Determines if the app can do background location updates.
    description: |
        When `UIBackgroundModes` include `location` in tiapp.xml, this property is
        set to `true` by default.
    type: Boolean
    default: false
    platforms: [iphone, ipad, macos]
    osver: {ios: {min: "9.0"}}
    since: "5.0.0"

  - name: activityType
    summary: |
        The type of user activity to be associated with the location updates.
    description: |
        The information in this property is used as a cue to determine when location
        updates may be automatically paused. Pausing updates gives the system the
        opportunity to save power in situations where the user's location is not likely
        to be changing. For example, if the activity type is
        [ACTIVITYTYPE_AUTOMOTIVE_NAVIGATION](Titanium.Geolocation.ACTIVITYTYPE_AUTOMOTIVE_NAVIGATION)
        and no location changes have occurred recently, the radios might be powered down
        until movement is detected again.
    type: Number
    constants: Titanium.Geolocation.ACTIVITYTYPE_*
    default: <Titanium.Geolocation.ACTIVITYTYPE_OTHER>
    since: "3.1.0"
    platforms: [iphone,ipad, macos]

  - name: locationAccuracyAuthorization
    summary: A value that indicates the level of location accuracy the app has permission to use.
    description: |
        If the value of this property is <Titanium.Geolocation.ACCURACY_AUTHORIZATION_FULL>, 
        you can set any constant to [accuracy](Titanium.Geolocation.accuracy). If value is 
        <Titanium.Geolocation.ACCURACY_AUTHORIZATION_REDUCED> setting [accuracy](Titanium.Geolocation.accuracy)
        to a value other than <Titanium.Geolocation.ACCURACY_REDUCED> has no effect on the location information.
    type: Number
    constants: [Titanium.Geolocation.ACCURACY_AUTHORIZATION_FULL, Titanium.Geolocation.ACCURACY_AUTHORIZATION_REDUCED]
    default: <Titanium.Geolocation.ACCURACY_AUTHORIZATION_REDUCED>
    osver: {ios: {min: "14.0"}}
    since: "9.2.0"
    platforms: [iphone,ipad]
    permission: read-only

  - name: pauseLocationUpdateAutomatically
    summary: Indicates whether the location updates may be paused.
    description: |
        Allowing the location updates to be paused can improve battery life on the
        target device without sacrificing location data. When this property is set to YES,
        the location updates are paused (and powers down the appropriate hardware) at
        times when the location data is unlikely to change. For example, if the user stops
        for food while using a navigation app, the location manager might pause updates for
        a period of time. You can help the determination of when to pause location updates
        by assigning a value to the [activityType](Titanium.Geolocation.activityType) property.
    type: Boolean
    default: false
    platforms: [iphone,ipad, macos]
    since: "3.1.0"

  - name: lastGeolocation
    summary: JSON representation of the last geolocation received.
    description: |
         LastEvent is the JSON version of the last geolocation sent by the OS. This does not
         trigger a geolocation attempt, nor wait for such. If no geolocation has happened,
         this value may be null or undefined.
    type: String
    since: "3.1.2"
    permission: read-only

---
name: LocationResults
summary: |
    Argument passed to the [getCurrentPosition](Titanium.Geolocation.getCurrentPosition) callback.
extends: ErrorResponse
properties:

  - name: provider
    platforms: [android]
    summary: If `success` is true, object describing the location provider generating this update.
    type: LocationProviderDict

  - name: coords
    summary: If `success` is true, actual location data for this update.
    type: LocationCoordinates

---
name: LocationCoordinates
summary: Simple object holding the data for a location update.
properties:

  - name: latitude
    summary: Latitude of the location update, in decimal degrees.
    type: Number

  - name: longitude
    summary: Longitude of the location update, in decimal degrees.
    type: Number

  - name: altitude
    summary: Altitude of the location update, in meters.
    type: Number

  - name: accuracy
    summary:  Accuracy of the location update, in meters.
    type: Number

  - name: altitudeAccuracy
    summary:  Vertical accuracy of the location update, in meters.
    type: Number
    osver: { android: { min: "8.0.0" } }

  - name: heading
    summary: |
        Compass heading, in degrees. May be unknown if device is not moving. On
        iOS, a negative value indicates that the heading data is not valid.
    type: Number

  - name: speed
    summary: |
        Current speed in meters/second. On iOS, a negative value indicates that the
        heading data is not valid or the accuracy is configured incorrectly.
        Note: Due to the Apple Geolocation API, set the <Titanium.Geolocation.accuracy>
        property to <Titanium.Geolocation.ACCURACY_BEST_FOR_NAVIGATION> in order to properly
        measure speed changes and prevent the app from returning negative values.
    type: Number

  - name: timestamp
    summary: Timestamp for this location update, in milliseconds.
    type: Number

  - name: floor
    summary: The floor of the building on which the user is located.
    type: LocationCoordinatesFloor
    osver: {ios: {min: "8.0"}}
    since: { iphone: "3.6.0", ipad: "3.6.0" }
    platforms: [iphone, ipad, macos]

---
name: LocationCoordinatesFloor
summary: |
    Simple object holding floor of the building on which the user is located.
properties:

  - name: level
    summary: The logical floor of the building.
    description: |
        Level values represent logical levels above or below ground level and are not
        intended to correspond to any numbering scheme in use by the building itself.
        The ground floor of a building is always represented by the value 0. Floors
        above the ground floor are represented by positive integers, so a value of 1
        represents the floor above ground level, a value of 2 represents two floors
        above ground level, and so on. Floors below the ground floor are represented
        by corresponding negative integers, with a value of -1 representing the floor
        immediately below ground level and so on.
    type: Number

---
name: ForwardGeocodeResponse
summary: |
    Simple object returned in the callback from the
    [forwardGeocoder](Titanium.Geolocation.forwardGeocoder) method.

    Note that Android includes a number of extra fields.
extends: ErrorResponse
platforms: [android, iphone, ipad, macos]
properties:
  - name: success
    summary: Indicates if the operation succeeded.
    description: Returns `true` if request succeeded, `false` otherwise.
    type: Boolean

  - name: error
    summary: Error message, if any returned.
    description: Will be undefined if `success` is `true`.
    type: String

  - name: code
    summary: Error code. Returns 0 if `success` is `true`.
    description: |
        Error code will be 0 if `success` is `true`, nonzero otherwise. If the error
        was generated by the operating system, that system's error value is used.
        Otherwise, this value will be -1.
    type: Number
    since: { android: "3.1.0", iphone: "3.1.0", ipad: "3.1.0" }
    
  - name: accuracy
    summary: Estimated accuracy of the geocoding, in meters.
    type: Number
    platforms: [iphone, ipad, macos]

  - name: longitude
    summary: Longitude of the geocoded address.
    type: String

  - name: latitude
    summary: Latitude of the geocoded address.
    type: String

  - name: street
    summary: Street name, without street address.
    type: String
    platforms: [android]

  - name: street1
    summary: Street name.
    type: String
    platforms: [android]

  - name: city
    summary: City name.
    type: String
    platforms: [android]

  - name: region1
    summary: First line of region.
    type: String
    platforms: [android]

  - name: region2
    summary: Not used.
    type: String
    platforms: [android]

  - name: postalCode
    summary: Postal code.
    type: String
    platforms: [android]

  - name: country
    summary: Country name.
    type: String
    platforms: [android]

  - name: countryCode
    summary: Country code.
    type: String
    platforms: [android]

  - name: country_code
    summary: Country code. Same as `countryCode`.
    type: String
    platforms: [android]

  - name: displayAddress
    summary: Display address. Identical to `address`.
    type: String
    platforms: [android]

  - name: address
    summary: Full address.
    type: String
    platforms: [android]

---
name: HeadingResponse
summary: |
    Argument passed to the [getCurrentHeading](Titanium.Geolocation.getCurrentHeading) callback.
extends: ErrorResponse
properties:
  - name: success
    summary: Indicates a successful operation.
    description: Returns `true` if request succeeded, `false` otherwise.
    type: Boolean
    platforms: [iphone, ipad, macos]

  - name: error
    summary: Error message, if any returned.
    description: Will be undefined if `success` is `true`.
    type: String
    platforms: [iphone, ipad, macos]

  - name: code
    summary: Error code.
    description: |
        Error code will be 0 if `success` is `true`, nonzero otherwise. If the error
        was generated by the operating system, that system's error value is used.
        Otherwise, this value will be -1.
    type: Number
    platforms: [iphone, ipad, macos]

  - name: heading
    summary: If `success` is true, the actual heading data.
    type: HeadingData

---
name: HeadingData
summary: Simple object holding compass heading data.
platforms: [iphone, ipad, android, macos]
properties:
  - name: accuracy
    summary: Accuracy of the compass heading, in platform-specific units.
    description: |
        On iOS, accuracy is returned as a maximum deviation in degrees,
        the smaller the value, the more accurate the heading is. For example,
        a value of 10 means the heading is plus or minus 10 degrees from the
        actual value. A negative value indicates the compass heading is invalid;
        for example, if there is magnetic interference, or if the compass is not calibrated.

        On Android, the value is set to either 1 (low accuracy), 2 (medium accuracy)
        or 3 (high accuracy). No specific definition of these accuracy values is supplied.
    type: Number

  - name: magneticHeading
    summary: Declination in degrees from magnetic North.
    type: Number

  - name: trueHeading
    summary: Declination in degrees from true North.
    description: |
        Calculating the true heading requires correcting the magnetic declination based on
        the device's current location. So `trueHeading` can only be calculated if the device
        has a fairly recent location fix. If you want to obtain the true heading, you
        should register for location updates as well as compass updates. The location fix
        does not need to be very accurate.

        On Android, `trueHeading` is `undefined` if a recent location fix is not available.

    type: Number

  - name: timestamp
    summary: Timestamp for the heading data, in milliseconds.
    type: Number

  - name: x
    summary: Raw geomagnetic data for the X axis.
    type: Number

  - name: y
    summary: Raw geomagnetic data for the Y axis.
    type: Number

  - name: z
    summary: Raw geomagnetic data for the Z axis.
    type: Number

---
name: LocationProviderDict
summary: Simple object describing a location provider.
description: |
    The `accuracy` and `power` values correspond to constants defined in the
    Android API. See
    [android.location.Criteria](https://developer.android.com/reference/android/location/Criteria.html)
    in the Android API Reference.

    These values are generalizations. In general, a provider with coarse accuracy will
    provide less accurate results than a provider with fine accuracy, and a provider with
    high power requirements will use more battery power than a provider with low power
    requirements.
properties:
  - name: accuracy
    summary: |
        Accuracy of the location provider, either fine (1) or coarse (2).
    type: Number

  - name: name
    summary: Name of the location provider.
    type: String

  - name: power
    summary: |
        Power consumption for this provider, either low (1), medium (2), or high (3).
    type: Number

---
name: ReverseGeocodeResponse
summary: |
    Simple object returned in the callback from the
    [reverseGeocoder](Titanium.Geolocation.reverseGeocoder) method.
extends: ErrorResponse
properties:
  - name: places
    summary: An array of reverse-geocoded addresses matching the requested location.
    type: Array<GeocodedAddress>

  - name: error
    summary: Error message, if any returned.
    description: Will be undefined if `success` is `true`.
    type: String
    since: "3.1.0"

  - name: code
    summary: Error code. Returns 0 if `success` is `true`.
    description: |
        Error code will be 0 if `success` is `true`, nonzero otherwise. If the error
        was generated by the operating system, that system's error value is used.
        Otherwise, this value will be -1.
    type: Number
    since: "3.1.0"

---
name: GeocodedAddress
summary: |
    Simple object representing a place, returned in the callback from the
    [reverseGeocoder](Titanium.Geolocation.reverseGeocoder) method.
platforms: [android, iphone, ipad, macos]
properties:
  - name: street
    summary: Street name, without street address.
    type: String

  - name: street1
    summary: Street name.
    type: String
    platforms: [android]

  - name: city
    summary: City name.
    type: String

  - name: region1
    summary: First line of region.
    type: String
    platforms: [android]

  - name: region2
    summary: Not used.
    type: String
    platforms: [android]

  - name: postalCode
    summary: Postal code
    type: String

  - name: state
    summary: State name.
    description: |
        This property may return the full name or abbreviated name.
    type: String

  - name: zipcode
    summary: Postal code. To be replaced by `postalCode`
    type: String
    platforms: [iphone, ipad]
    deprecated:
        since: {iphone: "8.0.0", ipad: "8.0.0"}
        removed: "9.0.0"
        notes: Use the `postalCode` property for parity.

  - name: country
    summary: Country name.
    type: String

  - name: countryCode
    summary: Country code.
    type: String

  - name: country_code
    summary: Country code. To be replaced by `countryCode`.
    type: String
    platforms: [android, iphone, ipad]
    deprecated:
        since: {android: "8.0.0", iphone: "8.0.0", ipad: "8.0.0"}
        removed: "9.0.0"
        notes: Use the `countryCode` property for parity.

  - name: longitude
    summary: Longitude of the geocoded point.
    type: Number

  - name: latitude
    summary: Latitude of the geocoded point.
    type: Number

  - name: displayAddress
    summary: Display address. Identical to `address`.
    type: String
    platforms: [android]
    deprecated:
        since: {android: "8.0.0"}
        removed: "9.0.0"
        notes: Use the `address` property for parity.

  - name: address
    summary: Full address.
    type: String

---
name: LocationAuthorizationResponse
summary: Argument passed to the callback when a request finishes successfully or erroneously.
extends: ErrorResponse

---
name: LocationAccuracyAuthorizationResponse
summary: Argument passed to the callback when a request finishes successfully or erroneously.
extends: ErrorResponse
properties:
  - name: accuracyAuthorization
    summary: The level of location accuracy the app has granted.
    description: Will be undefined if `error` is `true`.
    optional: true
    type: Number
    constants: [Titanium.Geolocation.ACCURACY_AUTHORIZATION_FULL, Titanium.Geolocation.ACCURACY_AUTHORIZATION_REDUCED]
